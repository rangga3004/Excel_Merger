<!DOCTYPE html>
<html>

<head>
    <base target="_top">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Manrope:wght@400;500;600;700;800&display=swap"
        rel="stylesheet">
    <style>
        /* AHA Commerce Brand Colors */
        :root {
            --aha-blue-primary: #2563EB;
            --aha-blue-dark: #1D4ED8;
            --aha-blue-darker: #1E40AF;
            --aha-blue-light: #3B82F6;
            --aha-indigo: #4F46E5;
            --bg-gradient-start: #2563EB;
            --bg-gradient-end: #1D4ED8;
            --text-white: #FFFFFF;
            --text-light: rgba(255, 255, 255, 0.9);
            --text-muted: rgba(255, 255, 255, 0.7);
            --card-bg: #FFFBF0;
            --card-shadow: 0 4px 20px rgba(0, 0, 0, 0.15);
            --button-dark: #1E3A5F;
            --success: #10B981;
            --success-bg: rgba(16, 185, 129, 0.15);
            --error: #EF4444;
            --error-bg: rgba(239, 68, 68, 0.15);
            --radius-sm: 8px;
            --radius-md: 12px;
            --radius-lg: 20px;
            --radius-xl: 28px;
            --radius-full: 9999px;
        }

        *,
        *::before,
        *::after {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        body {
            font-family: 'Manrope', -apple-system, BlinkMacSystemFont, sans-serif;
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 20px;
            background: linear-gradient(135deg, var(--bg-gradient-start) 0%, var(--bg-gradient-end) 100%);
        }

        .container {
            width: 100%;
            max-width: 580px;
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border-radius: var(--radius-xl);
            border: 1px solid rgba(255, 255, 255, 0.2);
            overflow: hidden;
            box-shadow: 0 25px 50px rgba(0, 0, 0, 0.2);
        }

        .header {
            padding: 28px 28px 20px;
            text-align: center;
            border-bottom: 1px solid rgba(255, 255, 255, 0.15);
        }

        .logo {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            margin-bottom: 8px;
        }

        .logo-icon {
            width: 42px;
            height: 42px;
        }

        .logo h1 {
            font-size: 1.6rem;
            font-weight: 800;
            color: var(--text-white);
            letter-spacing: -0.5px;
        }

        .subtitle {
            color: var(--text-light);
            font-size: 0.9rem;
            font-weight: 500;
        }

        .main {
            padding: 28px;
        }

        /* Upload Zone - Card Style like AHA bubbles */
        .upload-zone {
            background: var(--card-bg);
            border-radius: var(--radius-lg);
            padding: 40px 24px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: var(--card-shadow);
            border: none;
        }

        .upload-zone:hover {
            transform: translateY(-4px);
            box-shadow: 0 8px 30px rgba(0, 0, 0, 0.2);
        }

        .upload-zone.drag-over {
            transform: translateY(-4px);
            box-shadow: 0 0 0 3px var(--aha-blue-light), 0 8px 30px rgba(0, 0, 0, 0.2);
        }

        .upload-content {
            pointer-events: none;
        }

        .upload-icon {
            color: var(--aha-blue-primary);
            margin-bottom: 16px;
        }

        .upload-zone h2 {
            font-size: 1.2rem;
            font-weight: 700;
            margin-bottom: 8px;
            color: var(--aha-blue-darker);
        }

        .upload-zone p {
            color: #64748B;
            font-size: 0.9rem;
            font-weight: 500;
        }

        .browse-link {
            color: var(--aha-blue-primary);
            font-weight: 700;
            text-decoration: underline;
        }

        .hint {
            margin-top: 12px;
            font-size: 0.8rem !important;
            color: #94A3B8 !important;
        }

        /* Progress Section */
        .progress-section {
            display: none;
            padding: 20px;
            background: var(--card-bg);
            border-radius: var(--radius-lg);
            margin-bottom: 20px;
            box-shadow: var(--card-shadow);
        }

        .progress-section.active {
            display: block;
            animation: fadeIn 0.3s ease;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(-10px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .progress-header {
            display: flex;
            justify-content: space-between;
            margin-bottom: 12px;
        }

        .progress-title {
            font-weight: 600;
            color: var(--aha-blue-darker);
        }

        .progress-percent {
            color: var(--aha-blue-primary);
            font-weight: 700;
        }

        .progress-bar {
            height: 10px;
            background: #E2E8F0;
            border-radius: var(--radius-full);
            overflow: hidden;
            margin-bottom: 12px;
        }

        .progress-fill {
            height: 100%;
            width: 0%;
            background: linear-gradient(90deg, var(--aha-blue-primary), var(--aha-indigo));
            border-radius: var(--radius-full);
            transition: width 0.3s ease;
        }

        .progress-status {
            font-size: 0.85rem;
            color: #64748B;
            font-weight: 500;
        }

        /* File List Section */
        .file-list-section {
            display: none;
            margin-top: 20px;
        }

        .file-list-section.active {
            display: block;
            animation: fadeIn 0.3s ease;
        }

        .file-list-section h3 {
            font-size: 0.85rem;
            font-weight: 700;
            color: var(--text-light);
            margin-bottom: 10px;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .file-list {
            max-height: 180px;
            overflow-y: auto;
            background: var(--card-bg);
            border-radius: var(--radius-md);
            padding: 8px;
            box-shadow: var(--card-shadow);
        }

        .file-item {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 10px 12px;
            border-radius: var(--radius-sm);
            font-size: 0.85rem;
            color: #475569;
            font-weight: 500;
            transition: background 0.2s ease;
        }

        .file-item:hover {
            background: rgba(37, 99, 235, 0.08);
        }

        .file-item-icon {
            color: var(--aha-blue-primary);
            flex-shrink: 0;
        }

        .file-item-name {
            flex: 1;
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
        }

        .file-item-rows {
            font-size: 0.75rem;
            font-weight: 600;
            color: var(--aha-blue-primary);
            background: rgba(37, 99, 235, 0.1);
            padding: 3px 10px;
            border-radius: var(--radius-full);
        }

        /* Result Section */
        .result-section {
            display: none;
            text-align: center;
            padding: 28px 0;
        }

        .result-section.active {
            display: block;
            animation: fadeIn 0.3s ease;
        }

        .result-card {
            background: var(--card-bg);
            border-radius: var(--radius-lg);
            padding: 32px 24px;
            box-shadow: var(--card-shadow);
        }

        .result-icon {
            color: var(--success);
            margin-bottom: 16px;
        }

        .result-section h2 {
            font-size: 1.4rem;
            margin-bottom: 20px;
            color: var(--aha-blue-darker);
            font-weight: 800;
        }

        .result-stats {
            display: flex;
            justify-content: center;
            gap: 16px;
            margin-bottom: 24px;
            flex-wrap: wrap;
        }

        .stat-item {
            background: linear-gradient(135deg, var(--aha-blue-primary), var(--aha-indigo));
            padding: 14px 24px;
            border-radius: var(--radius-md);
            text-align: center;
            min-width: 120px;
        }

        .stat-value {
            font-size: 1.6rem;
            font-weight: 800;
            color: var(--text-white);
        }

        .stat-label {
            font-size: 0.7rem;
            color: var(--text-light);
            text-transform: uppercase;
            letter-spacing: 0.5px;
            font-weight: 600;
        }

        /* Buttons - AHA Style */
        .download-btn {
            display: inline-flex;
            align-items: center;
            gap: 8px;
            padding: 14px 32px;
            background: var(--button-dark);
            color: white;
            border: none;
            border-radius: var(--radius-full);
            font-size: 0.95rem;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(30, 58, 95, 0.3);
        }

        .download-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(30, 58, 95, 0.4);
            background: #162D4A;
        }

        .reset-btn {
            display: block;
            margin: 16px auto 0;
            padding: 10px 24px;
            background: transparent;
            color: #64748B;
            border: 2px solid #E2E8F0;
            border-radius: var(--radius-full);
            font-size: 0.9rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .reset-btn:hover {
            background: #F1F5F9;
            color: var(--aha-blue-darker);
            border-color: var(--aha-blue-primary);
        }

        /* Error Section */
        .error-section {
            display: none;
            text-align: center;
            padding: 28px 0;
        }

        .error-section.active {
            display: block;
            animation: fadeIn 0.3s ease;
        }

        .error-card {
            background: var(--card-bg);
            border-radius: var(--radius-lg);
            padding: 32px 24px;
            box-shadow: var(--card-shadow);
        }

        .error-icon {
            color: var(--error);
            margin-bottom: 16px;
        }

        .error-section h2 {
            color: var(--error);
            margin-bottom: 12px;
            font-weight: 800;
        }

        .error-message {
            color: #64748B;
            background: var(--error-bg);
            padding: 12px 16px;
            border-radius: var(--radius-md);
            margin-bottom: 20px;
            font-size: 0.9rem;
            font-weight: 500;
        }

        /* Footer */
        .footer {
            padding: 16px 28px;
            text-align: center;
            border-top: 1px solid rgba(255, 255, 255, 0.15);
            color: var(--text-muted);
            font-size: 0.8rem;
            font-weight: 500;
        }

        .footer a {
            color: var(--text-white);
            text-decoration: none;
            font-weight: 700;
        }

        /* Scrollbar */
        .file-list::-webkit-scrollbar {
            width: 6px;
        }

        .file-list::-webkit-scrollbar-track {
            background: transparent;
        }

        .file-list::-webkit-scrollbar-thumb {
            background: rgba(37, 99, 235, 0.3);
            border-radius: 3px;
        }

        .file-list::-webkit-scrollbar-thumb:hover {
            background: rgba(37, 99, 235, 0.5);
        }

        .upload-zone.hidden {
            display: none;
        }

        @media (max-width: 480px) {
            .container {
                border-radius: var(--radius-lg);
            }

            .header,
            .main {
                padding: 20px;
            }

            .upload-zone {
                padding: 32px 16px;
            }

            .logo h1 {
                font-size: 1.4rem;
            }

            .result-stats {
                gap: 10px;
            }

            .stat-item {
                padding: 12px 18px;
                min-width: 100px;
            }
        }
    </style>
</head>

<body>
    <div class="container">
        <header class="header">
            <div class="logo">
                <!-- AHA Commerce Logo -->
                <svg class="logo-icon" viewBox="0 0 42 42" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M21 3L38 36H4L21 3Z" fill="white" />
                    <path d="M21 12L30 30H12L21 12Z" fill="#2563EB" />
                </svg>
                <h1>Excel Merger</h1>
            </div>
            <p class="subtitle">Gabungkan file Excel multipart dari ZIP menjadi satu file</p>
        </header>

        <main class="main">
            <div class="upload-zone" id="uploadZone">
                <input type="file" id="fileInput" accept=".zip" hidden>
                <div class="upload-content">
                    <div class="upload-icon">
                        <svg width="56" height="56" viewBox="0 0 56 56" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <path d="M28 38V18M28 18L20 26M28 18L36 26" stroke="currentColor" stroke-width="3"
                                stroke-linecap="round" stroke-linejoin="round" />
                            <path d="M10 38V42C10 44.2091 11.7909 46 14 46H42C44.2091 46 46 44.2091 46 42V38"
                                stroke="currentColor" stroke-width="3" stroke-linecap="round" />
                        </svg>
                    </div>
                    <h2>Upload File ZIP</h2>
                    <p>Drag & drop file ZIP di sini, atau <span class="browse-link">browse</span></p>
                    <p class="hint">File ZIP berisi file Excel (.xlsx) yang akan digabungkan</p>
                </div>
            </div>

            <div class="progress-section" id="progressSection">
                <div class="progress-header">
                    <span class="progress-title" id="progressTitle">Memproses...</span>
                    <span class="progress-percent" id="progressPercent">0%</span>
                </div>
                <div class="progress-bar">
                    <div class="progress-fill" id="progressFill"></div>
                </div>
                <div class="progress-status" id="progressStatus">Menunggu...</div>
            </div>

            <div class="file-list-section" id="fileListSection">
                <h3>File Excel Ditemukan</h3>
                <div class="file-list" id="fileList"></div>
            </div>

            <div class="result-section" id="resultSection">
                <div class="result-card">
                    <div class="result-icon">
                        <svg width="56" height="56" viewBox="0 0 56 56" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <circle cx="28" cy="28" r="24" stroke="currentColor" stroke-width="3" />
                            <path d="M18 28L24 34L38 20" stroke="currentColor" stroke-width="3" stroke-linecap="round"
                                stroke-linejoin="round" />
                        </svg>
                    </div>
                    <h2>Merge Berhasil!</h2>
                    <div class="result-stats" id="resultStats"></div>
                    <button class="download-btn" id="downloadBtn">
                        <svg width="18" height="18" viewBox="0 0 18 18" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <path d="M9 3V11M9 11L5 7M9 11L13 7" stroke="currentColor" stroke-width="2"
                                stroke-linecap="round" stroke-linejoin="round" />
                            <path d="M3 11V13C3 14.1046 3.89543 15 5 15H13C14.1046 15 15 14.1046 15 13V11"
                                stroke="currentColor" stroke-width="2" stroke-linecap="round" />
                        </svg>
                        Download Hasil Merge
                    </button>
                    <button class="reset-btn" id="resetBtn">Upload File Lain</button>
                </div>
            </div>

            <div class="error-section" id="errorSection">
                <div class="error-card">
                    <div class="error-icon">
                        <svg width="56" height="56" viewBox="0 0 56 56" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <circle cx="28" cy="28" r="24" stroke="currentColor" stroke-width="3" />
                            <path d="M20 20L36 36M36 20L20 36" stroke="currentColor" stroke-width="3"
                                stroke-linecap="round" />
                        </svg>
                    </div>
                    <h2>Terjadi Kesalahan</h2>
                    <p class="error-message" id="errorMessage"></p>
                    <button class="reset-btn" id="errorResetBtn">Coba Lagi</button>
                </div>
            </div>
        </main>

        <footer class="footer">
            <p>Excel Merger v1.0 | <a href="#">AHA Commerce</a> Internal Tool</p>
        </footer>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/2.0.5/FileSaver.min.js"></script>
    <script>
        // DOM Elements
        const uploadZone = document.getElementById('uploadZone');
        const fileInput = document.getElementById('fileInput');
        const progressSection = document.getElementById('progressSection');
        const progressTitle = document.getElementById('progressTitle');
        const progressPercent = document.getElementById('progressPercent');
        const progressFill = document.getElementById('progressFill');
        const progressStatus = document.getElementById('progressStatus');
        const fileListSection = document.getElementById('fileListSection');
        const fileList = document.getElementById('fileList');
        const resultSection = document.getElementById('resultSection');
        const resultStats = document.getElementById('resultStats');
        const downloadBtn = document.getElementById('downloadBtn');
        const resetBtn = document.getElementById('resetBtn');
        const errorSection = document.getElementById('errorSection');
        const errorMessage = document.getElementById('errorMessage');
        const errorResetBtn = document.getElementById('errorResetBtn');

        let mergedWorkbook = null;
        let outputFileName = 'merged_excel.xlsx';

        // Event Listeners
        uploadZone.addEventListener('click', () => fileInput.click());
        uploadZone.addEventListener('dragover', handleDragOver);
        uploadZone.addEventListener('dragleave', handleDragLeave);
        uploadZone.addEventListener('drop', handleDrop);
        fileInput.addEventListener('change', handleFileSelect);
        downloadBtn.addEventListener('click', downloadMergedFile);
        resetBtn.addEventListener('click', resetApp);
        errorResetBtn.addEventListener('click', resetApp);

        function handleDragOver(e) {
            e.preventDefault();
            e.stopPropagation();
            uploadZone.classList.add('drag-over');
        }

        function handleDragLeave(e) {
            e.preventDefault();
            e.stopPropagation();
            uploadZone.classList.remove('drag-over');
        }

        function handleDrop(e) {
            e.preventDefault();
            e.stopPropagation();
            uploadZone.classList.remove('drag-over');
            const files = e.dataTransfer.files;
            if (files.length > 0) processFile(files[0]);
        }

        function handleFileSelect(e) {
            const files = e.target.files;
            if (files.length > 0) processFile(files[0]);
        }

        async function processFile(file) {
            if (!file.name.toLowerCase().endsWith('.zip')) {
                showError('File harus berformat .zip');
                return;
            }

            outputFileName = file.name.replace('.zip', '_merged.xlsx');
            uploadZone.classList.add('hidden');
            showProgress();

            try {
                updateProgress(10, 'Membaca file ZIP...');
                const zipData = await readFileAsArrayBuffer(file);

                updateProgress(20, 'Mengekstrak file ZIP...');
                const zip = await JSZip.loadAsync(zipData);

                updateProgress(30, 'Mencari file Excel...');
                const excelFiles = [];

                zip.forEach((relativePath, zipEntry) => {
                    if (!zipEntry.dir && relativePath.toLowerCase().endsWith('.xlsx')) {
                        if (!relativePath.startsWith('~$') && !relativePath.includes('/__MACOSX/')) {
                            excelFiles.push({
                                path: relativePath,
                                name: relativePath.split('/').pop(),
                                entry: zipEntry
                            });
                        }
                    }
                });

                if (excelFiles.length === 0) {
                    throw new Error('Tidak ditemukan file Excel (.xlsx) dalam ZIP');
                }

                excelFiles.sort((a, b) => naturalSort(a.name, b.name));

                updateProgress(40, `Memproses ${excelFiles.length} file Excel...`);

                const allData = [];
                let headerRow = null;
                let totalRows = 0;
                const fileStats = [];

                for (let i = 0; i < excelFiles.length; i++) {
                    const excelFile = excelFiles[i];
                    const progressPct = 40 + Math.round((i / excelFiles.length) * 40);
                    updateProgress(progressPct, `Memproses: ${excelFile.name}`);

                    const excelData = await excelFile.entry.async('arraybuffer');
                    const workbook = XLSX.read(excelData, { type: 'array' });
                    const sheetName = workbook.SheetNames[0];
                    const sheet = workbook.Sheets[sheetName];
                    const jsonData = XLSX.utils.sheet_to_json(sheet, { header: 1, defval: '' });

                    if (jsonData.length === 0) continue;

                    let dataRows;
                    if (headerRow === null) {
                        headerRow = jsonData[0];
                        dataRows = jsonData;
                    } else {
                        dataRows = jsonData.slice(1);
                    }

                    const rowCount = dataRows.length - (headerRow === jsonData[0] ? 1 : 0);
                    fileStats.push({ name: excelFile.name, rows: rowCount });
                    totalRows += rowCount;
                    allData.push(...dataRows);
                }

                displayFileList(fileStats);

                updateProgress(85, 'Membuat file Excel gabungan...');

                mergedWorkbook = XLSX.utils.book_new();
                const mergedSheet = XLSX.utils.aoa_to_sheet(allData);
                const colWidths = calculateColumnWidths(allData);
                mergedSheet['!cols'] = colWidths;
                XLSX.utils.book_append_sheet(mergedWorkbook, mergedSheet, 'Merged Data');

                updateProgress(100, 'Selesai!');

                setTimeout(() => {
                    showResult(excelFiles.length, totalRows);
                }, 500);

            } catch (error) {
                console.error('Error processing file:', error);
                showError(error.message || 'Terjadi kesalahan saat memproses file');
            }
        }

        function readFileAsArrayBuffer(file) {
            return new Promise((resolve, reject) => {
                const reader = new FileReader();
                reader.onload = (e) => resolve(e.target.result);
                reader.onerror = (e) => reject(new Error('Gagal membaca file'));
                reader.readAsArrayBuffer(file);
            });
        }

        function naturalSort(a, b) {
            const ax = [], bx = [];
            a.replace(/(\d+)|(\D+)/g, (_, $1, $2) => { ax.push([$1 || Infinity, $2 || '']) });
            b.replace(/(\d+)|(\D+)/g, (_, $1, $2) => { bx.push([$1 || Infinity, $2 || '']) });
            while (ax.length && bx.length) {
                const an = ax.shift();
                const bn = bx.shift();
                const nn = (an[0] - bn[0]) || an[1].localeCompare(bn[1]);
                if (nn) return nn;
            }
            return ax.length - bx.length;
        }

        function calculateColumnWidths(data) {
            if (!data || data.length === 0) return [];
            const colWidths = [];
            const maxWidth = 50;
            const minWidth = 10;
            const maxCols = Math.max(...data.map(row => (row ? row.length : 0)));
            for (let col = 0; col < maxCols; col++) {
                let maxLen = minWidth;
                const sampleSize = Math.min(data.length, 100);
                for (let row = 0; row < sampleSize; row++) {
                    if (data[row] && data[row][col] !== undefined) {
                        const cellLen = String(data[row][col]).length;
                        if (cellLen > maxLen) maxLen = cellLen;
                    }
                }
                colWidths.push({ wch: Math.min(maxLen + 2, maxWidth) });
            }
            return colWidths;
        }

        function displayFileList(fileStats) {
            fileList.innerHTML = fileStats.map(file => `
                <div class="file-item">
                    <div class="file-item-icon">
                        <svg width="16" height="16" viewBox="0 0 16 16" fill="none">
                            <path d="M3 2H10L13 5V14H3V2Z" stroke="currentColor" stroke-width="1.5"/>
                            <path d="M10 2V5H13" stroke="currentColor" stroke-width="1.5"/>
                        </svg>
                    </div>
                    <span class="file-item-name">${file.name}</span>
                    <span class="file-item-rows">${file.rows.toLocaleString()} rows</span>
                </div>
            `).join('');
            fileListSection.classList.add('active');
        }

        function updateProgress(percent, status) {
            progressPercent.textContent = `${percent}%`;
            progressFill.style.width = `${percent}%`;
            progressStatus.textContent = status;
        }

        function showProgress() {
            progressSection.classList.add('active');
            resultSection.classList.remove('active');
            errorSection.classList.remove('active');
            updateProgress(0, 'Memulai...');
        }

        function showResult(fileCount, rowCount) {
            progressSection.classList.remove('active');
            resultSection.classList.add('active');
            resultStats.innerHTML = `
                <div class="stat-item">
                    <div class="stat-value">${fileCount}</div>
                    <div class="stat-label">File Digabung</div>
                </div>
                <div class="stat-item">
                    <div class="stat-value">${rowCount.toLocaleString()}</div>
                    <div class="stat-label">Total Baris</div>
                </div>
            `;
        }

        function showError(message) {
            uploadZone.classList.add('hidden');
            progressSection.classList.remove('active');
            resultSection.classList.remove('active');
            fileListSection.classList.remove('active');
            errorSection.classList.add('active');
            errorMessage.textContent = message;
        }

        function downloadMergedFile() {
            if (!mergedWorkbook) {
                showError('Tidak ada file untuk didownload');
                return;
            }
            try {
                const wbout = XLSX.write(mergedWorkbook, { bookType: 'xlsx', type: 'array' });
                const blob = new Blob([wbout], { type: 'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet' });
                saveAs(blob, outputFileName);
            } catch (error) {
                console.error('Error downloading file:', error);
                showError('Gagal mendownload file');
            }
        }

        function resetApp() {
            mergedWorkbook = null;
            outputFileName = 'merged_excel.xlsx';
            fileInput.value = '';
            uploadZone.classList.remove('hidden');
            progressSection.classList.remove('active');
            fileListSection.classList.remove('active');
            resultSection.classList.remove('active');
            errorSection.classList.remove('active');
            fileList.innerHTML = '';
            updateProgress(0, 'Menunggu...');
        }

        console.log('Excel Merger (AHA Commerce) initialized');
    </script>
</body>

</html>